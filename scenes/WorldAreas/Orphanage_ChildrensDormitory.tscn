[gd_scene load_steps=13 format=4 uid="uid://cgr11keydyxqf"]

[ext_resource type="Script" uid="uid://bm1dpu20h5tgk" path="res://scripts/AreaTemplate.gd" id="1_xxxx"]
[ext_resource type="TileSet" uid="uid://ce704ljctriud" path="res://assets/tilesets/Main.tres" id="2_742d2"]
[ext_resource type="Script" uid="uid://c3v3pby11hsgf" path="res://scenes/WorldAreas/TileTorchLights.gd" id="3_jyrv2"]
[ext_resource type="Script" uid="uid://cgk4fkg7ww23a" path="res://scenes/WorldAreas/TileOccluders2D.gd" id="4_1ib1u"]
[ext_resource type="PackedScene" uid="uid://d276ynkuqbwbq" path="res://scenes/WorldAreas/InteractableDoor.tscn" id="5_i61xb"]
[ext_resource type="SpriteFrames" uid="uid://bdrnmmpkdu6bn" path="res://assets/sprites/Doors/WoodInteriorSingleDoor.tres" id="6_13rp7"]
[ext_resource type="Script" uid="uid://if0jfdljev7i" path="res://scripts/story/StoryGate.gd" id="7_ovgxs"]
[ext_resource type="Script" uid="uid://c81y2m3svd4b" path="res://scripts/story/WakeUpIntroCutscene.gd" id="8_bdgqs"]
[ext_resource type="PackedScene" uid="uid://coil8siiotaun" path="res://scenes/ui/DialogueBox.tscn" id="9_s2n1m"]
[ext_resource type="PackedScene" uid="uid://dye7xt7wi0rjh" path="res://scenes/Actors/NPCs/OrphanBoy.tscn" id="9_y1ofs"]
[ext_resource type="Script" uid="uid://cjnlnc13qv4i4" path="res://scenes/lighting/LightingController.gd" id="11_ky53w"]
[ext_resource type="SpriteFrames" uid="uid://cd8fulmiecy46" path="res://assets/sprites/characters/Player1Sleep.tres" id="12_0t6l0"]

[node name="Dormitory" type="Node2D"]
script = ExtResource("1_xxxx")
tileset = ExtResource("2_742d2")

[node name="L0_Ground" type="TileMapLayer" parent="."]
z_index = -10
tile_map_data = PackedByteArray("AAADAAAAAgADAAEAAAADAAEAAgADAAEAAAAFAAAAAgADAAEAAAAFAAEAAgADAAEAAAAHAAAAAgADAAEAAAAHAAEAAgADAAEAAAAJAAAAAgADAAEAAAAJAAEAAgADAAEAAAALAAAAAgADAAEAAAALAAEAAgADAAEAAAANAAAAAgADAAEAAAANAAEAAgADAAEAAAADAAUAAgADAAEAAAADAAQAAgADAAEAAAAFAAUAAgADAAEAAAAFAAQAAgADAAEAAAAHAAUAAgADAAEAAAAHAAQAAgADAAEAAAAJAAUAAgADAAEAAAAJAAQAAgADAAEAAAALAAUAAgADAAEAAAALAAQAAgADAAEAAAANAAUAAgADAAEAAAANAAQAAgADAAEAAAAAAP//AwABAAMAAAAAAAAAAwABAAQAAAAAAAEAAwABAAUAAAAAAAIAAwABAAYAAAAAAAMAAwABAAMAAAAAAAQAAwABAAQAAAAAAAUAAwABAAUAAAAAAAYAAwABAAYAAAAAAAcAAwABAAgAAAABAAcAAgADAAEAAAACAAcAAgADAAEAAAADAAcAAgADAAEAAAAEAAcAAgADAAEAAAAFAAcAAgADAAEAAAAGAAcAAgADAAEAAAAHAAcAAgADAAEAAAAIAAcAAgADAAEAAAAJAAcAAgADAAEAAAAKAAcAAgADAAEAAAALAAcAAgADAAEAAAAMAAcAAgADAAEAAAANAAcAAgADAAEAAAANAAYAAgADAAEAAAAOAAYAAgADAAEAAAAOAAcAAgADAAEAAAAPAAcAAgADAAEAAAAPAAYAAgADAAEAAAAPAAUAAgADAAEAAAAOAAUAAgADAAEAAAAOAAQAAgADAAEAAAAPAAQAAgADAAEAAAAOAAMAAgADAAEAAAAPAAIAAgADAAEAAAAPAAMAAgADAAEAAAAOAAIAAgADAAEAAAAPAAEAAgADAAEAAAAOAAEAAgADAAEAAAAOAAAAAgADAAEAAAAPAAAAAgADAAEAAAAPAP//AgADAAEAAAAPAP7/AgAJAAMAAAAOAP7/AgAEAAEAAAAOAP//AgADAAEAAAANAP//AgADAAEAAAANAP7/AgALAAEAAAAMAP7/AwAFAAIAAAALAP7/AwAFAAIAAAAKAP7/AgADAAAAAAAJAP7/AwAFAAIAAAAIAP7/AwAFAAIAAAAHAP7/AgADAAAAAAAGAP7/AwAFAAIAAAAFAP7/AwAFAAIAAAAEAP7/AgADAAAAAAADAP7/AwAFAAIAAAACAP7/AwAFAAIAAAABAP//AgADAAEAAAAMAP//AgADAAEAAAALAP//AgADAAEAAAAKAP//AgADAAEAAAAJAP//AgADAAEAAAAIAP//AgADAAEAAAAHAP//AgADAAEAAAAGAP//AgADAAEAAAAFAP//AgADAAEAAAAEAP//AgADAAEAAAADAP//AgADAAEAAAACAP//AgADAAEAAAAEAAIAAgADAAEAAAAEAAEAAgADAAEAAAAEAAAAAgADAAEAAAADAAIAAgADAAEAAAACAAIAAgADAAEAAAACAAEAAgADAAEAAAACAAAAAgADAAEAAAABAAAAAgADAAEAAAABAAEAAgADAAEAAAABAAIAAgADAAEAAAABAAMAAgADAAEAAAABAAQAAgADAAEAAAABAAUAAgADAAEAAAABAAYAAgADAAEAAAACAAYAAgADAAEAAAACAAUAAgADAAEAAAACAAQAAgADAAEAAAACAAMAAgADAAEAAAADAAMAAgADAAEAAAAEAAMAAgADAAEAAAAEAAQAAgADAAEAAAAEAAUAAgADAAEAAAAEAAYAAgADAAEAAAADAAYAAgADAAEAAAAFAAYAAgADAAEAAAAGAAYAAgADAAEAAAAGAAUAAgADAAEAAAAGAAQAAgADAAEAAAAGAAMAAgADAAEAAAAGAAIAAgADAAEAAAAGAAEAAgADAAEAAAAGAAAAAgADAAEAAAAFAAIAAgADAAEAAAAFAAMAAgADAAEAAAAHAAIAAgADAAEAAAAHAAMAAgADAAEAAAAIAAMAAgADAAEAAAAIAAIAAgADAAEAAAAIAAEAAgADAAEAAAAIAAAAAgADAAEAAAAJAAIAAgADAAEAAAAJAAMAAgADAAEAAAAKAAMAAgADAAEAAAAKAAIAAgADAAEAAAAKAAEAAgADAAEAAAAKAAAAAgADAAEAAAALAAIAAgADAAEAAAALAAMAAgADAAEAAAAMAAMAAgADAAEAAAAMAAIAAgADAAEAAAAMAAEAAgADAAEAAAAMAAAAAgADAAEAAAANAAIAAgADAAEAAAANAAMAAgADAAEAAAAMAAQAAgADAAEAAAAMAAUAAgADAAEAAAAMAAYAAgADAAEAAAALAAYAAgADAAEAAAAKAAYAAgADAAEAAAAKAAUAAgADAAEAAAAKAAQAAgADAAEAAAAJAAYAAgADAAEAAAAIAAYAAgADAAEAAAAIAAUAAgADAAEAAAAIAAQAAgADAAEAAAAHAAYAAgADAAEAAAAAAP7/AgADAAAAAAABAP7/AgADAAAAAAAAAP3/AgADAAAAAAABAP3/AgADAAAAAAACAP3/AgADAAAAAAADAP3/AgADAAAAAAAEAP3/AgADAAAAAAAFAP3/AgADAAAAAAAGAP3/AgADAAAAAAAHAP3/AgADAAAAAAAIAP3/AgADAAAAAAAJAP3/AgADAAAAAAAKAP3/AgADAAAAAAALAP3/AgADAAAAAAAMAP3/AgADAAAAAAANAP3/AgALAAAAAAAOAP3/AgAEAAEAAAAPAP3/AgAJAAIAAAACAAgAAwACAAkAAAADAAgAAwADAAkAAAAFAAgAAwACAAkAAAAGAAgAAwADAAkAAAAIAAgAAwACAAkAAAAJAAgAAwADAAkAAAALAAgAAwACAAkAAAAMAAgAAwADAAkAAAA=")
tile_set = ExtResource("2_742d2")

[node name="L1_Details" type="TileMapLayer" parent="."]
z_index = 1
tile_map_data = PackedByteArray("AAAOAP3/AgAJAAAAAAAOAP7/AgAJAAEAAAAKAP3/BQAAAAAAAAAHAP3/BQAAAAAAAAAEAP3/BQAAAAAAAAA=")
tile_set = ExtResource("2_742d2")

[node name="L2_Colliders" type="TileMapLayer" parent="."]
z_index = -1
tile_map_data = PackedByteArray("AAD///7/AwAAAAIAAAD/////AwAAAAMAAAD//wAAAwAAAAgAACD//wEAAwAAAAcAACD//wIAAwAAAAYAACD//wMAAwAAAAUAACD//wQAAwAAAAQAACD//wUAAwAAAAMAACD//wYAAwAAAAIAACD//wcAAwAAAAEAACAQAP3/AwAAAAEAABAQAP7/AwAAAAIAABAQAP//AwAAAAMAABAQAAAAAwAAAAQAABAQAAEAAwAAAAUAABAQAAIAAwAAAAYAABAQAAMAAwAAAAcAABAQAAQAAwAAAAgAABAQAAUAAwAAAAMAADAQAAYAAwAAAAIAADAQAAcAAwAAAAEAADD///3/AwAAAAEAAAD///z/AwAAAAAAAAAQAAgAAwAAAAAAADD//wgAAwAAAAAAACAQAPz/AwAAAAAAABAAAPz/AwABAAAAAAABAPz/AwACAAAAAAACAPz/AwADAAAAAAADAPz/AwAEAAAAAAAEAPz/AwAFAAAAAAAFAPz/AwAGAAAAAAAGAPz/AwAHAAAAAAAHAPz/AwABAAAAAAAIAPz/AwACAAAAAAAJAPz/AwADAAAAAAAKAPz/AwAEAAAAAAALAPz/AwAFAAAAAAAMAPz/AwAGAAAAAAANAPz/AwAHAAAAAAAOAPz/AwAIAAAAAAAPAPz/AwAJAAAAAAABAAgAAwACAAkAAAACAAgAAgACAAUAAAADAAgAAgADAAUAAAAEAAgAAwAFAAkAAAAFAAgAAgACAAUAAAAGAAgAAgADAAUAAAAHAAgAAwABAAkAAAAIAAgAAgACAAUAAAAJAAgAAgADAAUAAAAAAAgAAwABAAkAAAAKAAgAAwAEAAkAAAALAAgAAgACAAUAAAAMAAgAAgADAAUAAAANAAgAAwAHAAkAAAAOAAgAAwAIAAkAAAAPAAgAAwAJAAkAAAAAAAEAAgABAAAAAAAAAAIAAgABAAAAAAAAAAMAAgABAAAAAAAAAAQAAgAAAAAAAAAAAP7/AwABAAIAAAABAP7/AwACAAIAAAACAP7/AgAAAAMAAAADAP7/AgABAAMAAAAEAP7/AgAEAAMAAAAFAP7/AgAAAAMAAAAHAP7/AgAEAAMAAAAIAP7/AgAAAAMAAAAJAP7/AgABAAMAAAAKAP7/AgAEAAMAAAALAP7/AgAAAAMAAAAMAP7/AgABAAMAAAAAAP3/AgADAAAAAAABAP3/AgADAAAAAAACAP3/AgADAAAAAAADAP3/AgADAAAAAAAEAP3/AgADAAAAAAAFAP3/AgADAAAAAAAGAP3/AgADAAAAAAAHAP3/AgADAAAAAAAIAP3/AgADAAAAAAAJAP3/AgADAAAAAAAKAP3/AgADAAAAAAALAP3/AgADAAAAAAAMAP3/AgADAAAAAAAHAAcAAwAEAAgAAAAEAAcAAwAEAAgAAAANAAcAAwAEAAgAAAAEAP//AgAEAAQAAAAHAP//AgAEAAQAAAAKAP//AgAEAAQAAAANAP7/AwAGAAIAAAAPAP7/AwAIAAIAAAAOAP7/AwAHAAIAAAACAAYAAgACAAMAAAACAAcAAgACAAQAAAADAAYAAgADAAMAAAADAAcAAgADAAQAAAAFAAYAAgACAAMAAAAFAAcAAgACAAQAAAAGAAYAAgADAAMAAAAGAAcAAgADAAQAAAAIAAYAAgACAAMAAAAIAAcAAgACAAQAAAAJAAYAAgADAAMAAAAJAAcAAgADAAQAAAALAAYAAgACAAMAAAALAAcAAgACAAQAAAAMAAYAAgADAAMAAAAMAAcAAgADAAQAAAACAP//AgAAAAQAAAACAAAAAgAAAAUAAAADAP//AgABAAQAAAADAAAAAgABAAUAAAAFAP//AgAAAAQAAAAFAAAAAgAAAAUAAAAIAP//AgAAAAQAAAAIAAAAAgAAAAUAAAAJAP//AgABAAQAAAAJAAAAAgABAAUAAAALAP//AgAAAAQAAAALAAAAAgAAAAUAAAAMAP//AgABAAQAAAAMAAAAAgABAAUAAAAGAAAAAgABAAUAAAAGAP//AgABAAQAAAAGAP7/AgABAAMAAAAKAAcAAwAEAAgAAAAOAAMABgAFAAYAAAAOAAQABgAFAAcAAAAOAAUABgAFAAgAAAAPAAMABgAGAAYAAAAPAAQABgAGAAcAAAAPAAUABgAGAAgAAAA=")
tile_set = ExtResource("2_742d2")

[node name="L3_Overhangs" type="TileMapLayer" parent="."]
z_index = 10
tile_map_data = PackedByteArray("AAABAAcAAwABAAoAAGABAAgAAwAAAAoAAGAFAAcAAwABAAoAAGAFAAgAAwAAAAoAAGAJAAcAAwABAAoAAGAJAAgAAwAAAAoAAGANAAcAAwABAAoAAGANAAgAAwAAAAoAAGABAPz/AwAAAAoAAEABAP3/AwABAAoAAEAFAPz/AwAAAAoAAEAFAP3/AwABAAoAAEAJAPz/AwAAAAoAAEAJAP3/AwABAAoAAEANAPz/AwAAAAoAAEANAP3/AwABAAoAAEABAAYAAwABAAoAAGABAAUAAwACAAoAAGABAAQAAwADAAoAAGABAAMAAwAEAAoAAGABAAIAAwAFAAoAAGABAAEAAwAGAAoAAGABAAAAAwAHAAoAAGABAP//AwAIAAoAAGABAP7/AwAJAAoAAGAFAAYAAwABAAoAAGAFAAUAAwACAAoAAGAFAAQAAwADAAoAAGAFAAMAAwAEAAoAAGAFAAIAAwAFAAoAAGAFAAEAAwAGAAoAAGAFAAAAAwAHAAoAAGAFAP//AwAIAAoAAGAFAP7/AwAJAAoAAGAJAAYAAwABAAoAAGAJAAUAAwACAAoAAGAJAAQAAwADAAoAAGAJAAMAAwAEAAoAAGAJAAIAAwAFAAoAAGAJAAEAAwAGAAoAAGAJAAAAAwAHAAoAAGAJAP//AwAIAAoAAGAJAP7/AwAJAAoAAGANAAYAAwABAAoAAGANAAUAAwACAAoAAGANAAQAAwADAAoAAGANAAMAAwAEAAoAAGANAAIAAwAFAAoAAGANAAEAAwAGAAoAAGANAAAAAwAHAAoAAGANAP//AwAIAAoAAGANAP7/AwAJAAoAAGA=")
tile_set = ExtResource("2_742d2")

[node name="EntryPoints" type="Node2D" parent="."]
position = Vector2(226, 9)

[node name="default" type="Node2D" parent="EntryPoints"]

[node name="WakeUp" type="Marker2D" parent="EntryPoints"]
position = Vector2(-152, 5)

[node name="TorchLights" type="Node2D" parent="."]
script = ExtResource("3_jyrv2")
target_layer_path = NodePath("../L1_Details")
torch_source_ids = Array[int]([5])
light_radius_pixels = 85
light_energy_base = 0.75
use_shadows = true
flicker_speed_hz = 5.0

[node name="Occluders" type="Node2D" parent="."]
script = ExtResource("4_1ib1u")
target_layer_path = NodePath("../L2_Colliders")
edge_thickness_pixels = 2.0
push_out_pixels = 0.75
trim_corners_pixels = 0.5

[node name="Occluders2" type="Node2D" parent="."]
script = ExtResource("4_1ib1u")
target_layer_path = NodePath("../L3_Overhangs")
edge_thickness_pixels = 2.0
push_out_pixels = 1.0
trim_corners_pixels = 0.5

[node name="InteractableDoor" parent="." instance=ExtResource("5_i61xb")]
position = Vector2(232, -31)

[node name="CollisionShape2D" parent="InteractableDoor" index="0"]
position = Vector2(0, 0)

[node name="AnimatedSprite2D" parent="InteractableDoor" index="1"]
position = Vector2(0, -1)
sprite_frames = ExtResource("6_13rp7")
animation = &"closed"

[node name="IntroStoryGate" type="Node" parent="."]
script = ExtResource("7_ovgxs")
required_act_id = 1
required_step_id = 1
required_flags = PackedStringArray()
forbidden_flags = PackedStringArray("QUEST_RATS_ACTIVE")
set_act_id_after = 1
set_step_id_after = 1
flags_to_set_after = PackedStringArray("QUEST_RATS_ACTIVE", "")

[node name="WakeUpIntro" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_left = 27.0
offset_top = 50.0
offset_right = 67.0
offset_bottom = 90.0
script = ExtResource("8_bdgqs")
dialogue_box_scene = ExtResource("9_s2n1m")
story_gate_path = NodePath("../IntroStoryGate")
orphan_node_path = NodePath("../OrphanBoy")
bed_sleep_sprite_path = NodePath("../SleepingBed/AnimatedSprite2D")
orphan_walk_duration = 1.6
sleep_duration = 5.0
default_player_name = "Player1"

[node name="OrphanBoy" parent="." instance=ExtResource("9_y1ofs")]
position = Vector2(214, 109)
sprite_path = NodePath("AnimatedSprite2D")
talk_lines = PackedStringArray("I hope we have something other than porridge tonight...", "I miss Richard. He taught me I didn\'t need a mommy!", "Have you seen my marbles?")

[node name="LightingController" type="Node" parent="."]
script = ExtResource("11_ky53w")
debug_logging = false
torch_tiles_path = NodePath("../L1_Details")
torch_lit_source_id = 5
torch_unlit_source_id = 2
torch_unlit_atlas = Vector2i(2, 1)
window_tiles_path = NodePath("../L1_Details")
window_day_source_id = 3
window_day_atlas = Vector2i(4, 14)
window_night_source_id = 3
window_night_atlas = Vector2i(3, 14)
fireplace_tiles_path = NodePath("../L1_Details")
fireplace_lit_source_id = 10
fireplace_lit_atlas = Vector2i(0, 3)
fireplace_unlit_source_id = 10
fireplace_unlit_atlas = Vector2i(0, 2)
torch_lights_node_path = NodePath("../TorchLights")

[node name="SleepingBed" type="Node2D" parent="."]

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="SleepingBed"]
position = Vector2(48, -13)
sprite_frames = ExtResource("12_0t6l0")
animation = &"emptybed"

[editable path="InteractableDoor"]
[editable path="OrphanBoy"]
